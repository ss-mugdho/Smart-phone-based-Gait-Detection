clc;
frs = 150;
N = floor(length(X)/frs);
x = [];
y = [];
z = [];
x1 = [];
y1 = [];
z1 = [];
features = [];
lebel = {};
for i = 1:N
    x = X(1+(i-1)*75:150+(i-1)*75);
    y = Y(1+(i-1)*75:150+(i-1)*75);
    z = Z(1+(i-1)*75:150+(i-1)*75);
    x1 = X1(1+(i-1)*75:150+(i-1)*75);
    y1 = Y1(1+(i-1)*75:150+(i-1)*75);
    z1 = Z1(1+(i-1)*75:150+(i-1)*75);
    n = length(x);
    a0 = [x y z]';
    g0 = [x1 y1 z1]';
    %plot(a0(3,:))
    b = (sum(a0'))'/n;
    q1 = atan(b(2)/b(3));
    q2 = atan(b(1)/(b(2)*sin(q1)+b(3)*cos(q1)));
    r1 = [cos(q2) -sin(q1)*sin(q2) -cos(q1)*sin(q2)];
    r2 = [0 cos(q1) -sin(q1)];
    r3 = [sin(q2) sin(q1)*cos(q2) cos(q1)*cos(q2)];
    r = [r1;r2;r3];
    a1 = r*a0;
    g1 = r*g0;
    a1z = sum(a1(3,:))/n;
    a2 = [a1(1,:);a1(2,:);a1(3,:)-a1z];
    ah = sqrt(a2(1,:).^2 + a2(2,:).^2);
    av = abs(a2(3,:));
    gh = sqrt(g1(1,:).^2 + g1(2,:).^2);
    gv = abs(g1(3,:));
    eah = sum(ah.^2)/frs;
    eav = sum(av.^2)/frs;
    egh = sum(gh.^2)/frs;
    egv = sum(gv.^2)/frs;
    rms = [eav eah egv egh];
    actv = var(av);
    acth = var(ah);
    activity = [actv acth];
    mobv = std(diff(av))./std(av);
    mobh = std(diff(ah))./std(ah);
    mobility = [mobv mobh];
    compv = std(diff(diff(av)))./std(diff(av))./mobv;
    comph = std(diff(diff(ah)))./std(diff(ah))./mobh;
    complexity = [compv comph];
    maxa = [max(a2(1,:)) max(a2(2,:)) max(a2(3,:))];
    maxg = [max(g1(1,:)) max(g1(2,:)) max(g1(3,:))];
    maxval = [maxa maxg];
    maxca = [max(xcorr(a2(1,:))) max(xcorr(a2(2,:))) max(xcorr(a2(3,:)))];
    maxcg = [max(xcorr(g1(1,:))) max(xcorr(g1(2,:))) max(xcorr(g1(3,:)))];
    maxcorr = [maxca maxcg];
    meana = [mean(abs(a2(1,:))) mean(abs(a2(2,:))) mean(abs(a2(3,:)))];
    meang = [mean(abs(g1(1,:))) mean(abs(g1(2,:))) mean(abs(g1(3,:)))];
    meanval = [meana meang];
    type = 'normal';
    feature = [meanval rms maxval maxcorr activity mobility complexity];
    features = [features;feature];
    lebel = [lebel;type];
end
T115 = table(features,lebel);
save('ftr115.mat','T115');
clear all;